Help me refactor this code:

## Current Code
```
[PASTE CODE HERE]
```

## Refactoring Goals
- [ ] Improve readability
- [ ] Reduce complexity
- [ ] Better performance
- [ ] Follow best practices
- [ ] Other: [specify]

## Constraints
- Maintain existing functionality
- [Any other constraints]

Please provide:
1. Refactored code with explanations
2. Key improvements made
3. Any trade-offs or considerations
